# 卷了么 - 使用指南

## 简介

卷了么是一款智能出勤记录与分析工具，帮助您：
- 📸 拍照识别打卡记录
- 📝 粘贴文本快速录入
- 📊 自动计算和分析工时
- 🏆 根据出勤表现生成专属搞笑称号 + 鼓励/赞美语

## 快速开始

### 1. 环境准备

确保已安装 Node.js（建议 v16+）：

```bash
node --version
```

### 2. 安装依赖

```bash
npm install
```

### 3. 配置 API Key

1. 复制环境变量文件：
```bash
cp .env.example .env
```

2. 编辑 `.env` 文件，填入您的 SiliconFlow API Key：
```
VITE_SILICONFLOW_API_KEY=sk-xxxxxx...
```

**获取 API Key：**
- 访问 [SiliconFlow Cloud](https://cloud.siliconflow.cn)
- 注册/登录账号
- 在 API 密钥管理页面创建密钥

### 4. 启动应用

```bash
npm run dev
```

访问 http://localhost:5173

## 功能说明

### 识别打卡记录

#### 方式一：图片上传识别

1. 点击上传区域或拖拽打卡截图到框内
2. 支持 PNG、JPG 格式
3. 点击「识别打卡时间」
4. AI 自动识别并生成工时记录

**识别原理：**
- 使用 GLM-4.6V 多模态模型分析图片
- 自动提取打卡时间点
- 按日期分组返回识别结果

#### 方式二：文本粘贴识别（推荐）

1. 直接在输入框粘贴打卡信息文本
2. 点击「识别打卡时间」
3. AI 自动解析文本中的打卡记录

**优势：**
- 无需截图，操作更便捷
- 响应速度更快（已优化推理模式）

### 查看分析结果

识别完成后，您可以查看：

| 模块 | 说明 |
|------|------|
| 🏆 专属称号 | 根据出勤表现生成的搞笑称号和鼓励/赞美语 |
| 📈 工时趋势图 | 展示每日工时变化，含平均工时标准线 |
| 📋 工时记录列表 | 所有出勤记录的详细列表 |

### 未来出勤计划

系统会根据您的历史出勤数据，智能预测未来工作日的工时目标。

#### 策略模式

系统提供三种策略模式，满足不同工作强度需求：

| 策略 | 系数 | 说明 |
|------|------|------|
| 🛋️ 躺平模式 | 85% | 轻松达标，适合佛系工作者 |
| 🐮 牛马模式 | 100% | 标准目标，适合普通打工人 |
| 🔥 卷王模式 | 120% | 挑战自我，适合奋斗达人 |

#### 使用方法

1. 在「工时分析」卡片中找到「未来5个工作日出勤计划」模块
2. 点击顶部策略按钮切换模式：
   - 按钮会高亮显示当前选中的策略
   - 策略说明显示在按钮下方（系数 + 目标平均）
3. 切换策略后：
   - 系统自动计算新的每日目标工时
   - 所有日期输入框自动更新为推荐值
   - 建议文案也会随之变化
   - 图表中的预测数据实时更新

#### 数据解读

| 指标 | 说明 |
|------|------|
| 当前平均 | 历史出勤的平均工时 |
| 目标平均 | 根据策略计算的目标平均值 |
| 未来需达到 | 普通日需达到的工时（周五固定8h） |
| 建议 | 根据当前状态给出的温馨提示 |
| 计划工时 | 未来5天计划工时总和 |

#### 自定义调整

您可以手动修改任意日期的计划工时：
1. 点击日期输入框
2. 输入期望的工时值（0-24小时）
3. 打卡时间建议会**自动重新计算**
4. 图表会实时反映您的自定义计划

> **提示**：预测数据会在图表中以灰色虚线柱显示，与历史数据区分。

#### 打卡时间建议

系统在每个日期卡片下方显示建议的上班打卡时间和下班打卡时间：

| 项目 | 说明 |
|------|------|
| 🏢 上班时间 | 建议的最晚上班打卡时间 |
| 🏠 下班时间 | 建议的最早下班打卡时间 |

**智能计算方式：**

系统使用 AI（DeepSeek-V3.2 模型）根据**需要达到的平均工时**智能计算合理的打卡时间建议：

1. **输入**：目标平均工时（根据策略计算）、午休时间
2. **AI 处理**：分析并生成平衡的上下班时间方案
3. **输出**：建议的上班打卡时间和下班打卡时间

**计算规则：**

| 目标工时 | 上班打卡 | 下班打卡 | 说明 |
|---------|----------|----------|------|
| 8h | 9:30 | 19:00 | 按公司最低标准 |
| 10h | 8:45 | 19:00 | 提前45分钟上班 |
| 12h | 8:30 | 20:30 | 提前1h上班，晚1.5h下班 |
| 14h | 8:00 | 21:30 | 提前1.5h上班，晚2.5h下班 |

**平衡原则：**
- AI 会**智能平衡**提前上班和延后下班的时间
- 优先考虑合理的工作时间分布
- 上班时间不早于 7:00，下班时间不晚于 23:59

**本地备选：**
- 如果没有配置 API Key，系统使用本地算法计算
- 本地算法采用 60% 提前上班 + 40% 延后下班的平衡策略

> **注意**：打卡时间建议基于需要达到的平均工时计算，而非固定的公司规定时间。

**周五特殊规则：**
- 如果未来5天内有周五，周五当天只需出勤 **8小时**
- 周五打卡时间固定为 09:30 - 18:00（标准工时）
- 缺的时长（8小时与原目标之差）会**分摊到其余工作日**
- 确保整体平均工时仍能达到目标

**策略切换与缓存：**
- 首次切换到某策略时，系统会请求 AI 生成打卡时间建议
- 切换策略后，系统会**自动缓存**该策略的预测数据
- 再次切换回已缓存的策略时，**无需再次请求 AI**，直接使用缓存数据
- 页面刷新后，缓存数据仍可从本地存储恢复

**躺平模式特殊规则：**
- 如果躺平模式的目标工时低于 8 小时，系统会按 8 小时计算打卡时间建议
- 确保打卡时间合理，避免过早上班或过晚下班

### 手动录入工时

如需手动添加记录：

1. 点击「+ 手动录入工时」按钮
2. 填写日期、上班时间、下班时间
3. 点击「添加记录」保存

## 数据规则

### 打卡时间有效性

| 情况 | 处理方式 |
|------|----------|
| 早于 7:00 的上班打卡 | 自动过滤，不纳入计算 |
| 超过 9:30 的上班打卡 | 统计为迟到 |
| 早于 18:00 的下班打卡 | 统计为早退 |

### 工时计算规则

工时计算基于午休时间范围进行：

1. **正常情况**：上班时间在午休开始之前
   - 工时 = (午休开始时间 - 上班打卡时间) + (下班时间 - 午休结束时间)

2. **上班时间在午休结束后**：上班打卡时间晚于午休结束时间
   - 工时 = 下班时间 - 上班时间

3. **上班时间在午休期间**：上班打卡时间在午休时间范围内
   - 工时 = 下班时间 - 午休结束时间

4. **缺勤情况**：只有上班打卡或只有下班打卡
   - 工时 = 0

### 数据覆盖

- 每次识别的新数据会**完全替换**已有数据
- 记录按日期升序排列展示

### 数据存储

- 所有数据保存在浏览器本地存储 (localStorage)
- 清除浏览器缓存会导致数据丢失
- 建议定期查看和备份重要数据

## 常见问题

### Q: API 调用失败？

**A:** 请检查：
1. `.env` 文件中的 API Key 是否正确
2. SiliconFlow 账户是否有足够余额
3. 网络连接是否正常

### Q: 图片识别不准确？

**A:** 尝试以下方法：
- 上传更清晰的打卡截图
- 确保图片中的时间文字清晰可读
- 避免图片过大或过小
- 尝试使用文本粘贴方式

### Q: 响应速度慢？

**A:** 文本识别已开启加速模式，如仍慢请检查：
- 网络连接
- API 账户余额

### Q: 如何修改午休时间？

**A:** 在「基本设置」中修改「默认午休时间」即可，例如 12:00~13:30。系统会根据您设置的时间范围自动计算工时。

### Q: 工时是如何计算的？

**A:** 工时计算规则如下：

| 情况 | 计算公式 |
|------|----------|
| 正常情况 | 工时 = (午休开始时间 - 上班打卡时间) + (下班时间 - 午休结束时间) |
| 上班时间在午休结束后 | 工时 = 下班时间 - 上班时间 |
| 上班时间在午休期间 | 工时 = 下班时间 - 午休结束时间 |
| 缺少上班或下班打卡 | 工时 = 0（缺勤） |

### Q: 数据会丢失吗？

**A:** 数据存储在浏览器 localStorage 中，清除缓存会丢失。建议定期记录重要数据。

## 界面说明

### 主界面布局

```
┌─────────────────────────────────────────┐
│  🏢 卷了么                          ⚙️ API │ ← 头部
├──────────┬──────────────────────────────┤
│          │                              │
│ ⚙️ 基本  │  🏆 专属称号 + 鼓励/赞美语      │
│ 设置     │  ─────────────────────────   │
│          │  📈 工时趋势图（含平均线）      │
│ ──────── │                              │
│ 📝 手动  │  📋 工时记录列表              │
│ 录入     │                              │
│          │                              │
│ 🖼️ 图片  │                              │
│ /文本    │                              │
│ 上传     │                              │
│          │                              │
└──────────┴──────────────────────────────┘
│  👨‍💻 制作人：iflow  |  🤖 模型：xxx   │ ← 页脚
└─────────────────────────────────────────┘
```

## 技术支持

如有问题，请：
1. 查看浏览器控制台（F12）的错误信息
2. 检查 SiliconFlow API 余额
3. 确认图片格式和清晰度
4. 尝试使用文本粘贴方式

## 许可证

MIT License
